"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/fiches-horaires";
exports.ids = ["pages/api/fiches-horaires"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiches-horaires&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffiches-horaires%2Findex.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiches-horaires&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffiches-horaires%2Findex.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_fiches_horaires_index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/fiches-horaires/index.js */ \"(api-node)/./pages/api/fiches-horaires/index.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_fiches_horaires_index_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_fiches_horaires_index_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_fiches_horaires_index_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_fiches_horaires_index_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/fiches-horaires\",\n        pathname: \"/api/fiches-horaires\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_fiches_horaires_index_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGZmljaGVzLWhvcmFpcmVzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZmaWNoZXMtaG9yYWlyZXMlMkZpbmRleC5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDRTtBQUMxRDtBQUNpRTtBQUNqRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsZ0VBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLGdFQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLHlHQUFtQjtBQUNsRDtBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2ZpY2hlcy1ob3JhaXJlcy9pbmRleC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZmljaGVzLWhvcmFpcmVzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZmljaGVzLWhvcmFpcmVzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiches-horaires&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffiches-horaires%2Findex.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/fiches-horaires/index.js":
/*!********************************************!*\
  !*** ./pages/api/fiches-horaires/index.js ***!
  \********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_1__]);\nformidable__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nconst fichesDir = path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), 'public', 'fiches-horaires');\nasync function query(sql, params) {\n    console.log('Connecting to DB with:', {\n        host: process.env.MYSQL_HOST,\n        user: process.env.MYSQL_USER,\n        database: process.env.MYSQL_DATABASE\n    });\n    const connection = await mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createConnection({\n        host: process.env.MYSQL_HOST || '127.0.0.1',\n        port: process.env.MYSQL_PORT ? parseInt(process.env.MYSQL_PORT) : 8889,\n        user: process.env.MYSQL_USER,\n        password: process.env.MYSQL_PASSWORD,\n        database: process.env.MYSQL_DATABASE\n    });\n    const [results] = await connection.execute(sql, params);\n    await connection.end();\n    return results;\n}\nasync function handler(req, res) {\n    if (req.method === 'GET') {\n        try {\n            const results = await query('SELECT * FROM fiches_horaires ORDER BY created_at DESC');\n            res.status(200).json(results);\n        } catch (error) {\n            console.error('Error fetching fiches horaires:', error);\n            res.status(500).json({\n                error: 'Erreur lors de la récupération des fiches horaires'\n            });\n        }\n    } else if (req.method === 'POST') {\n        // Ensure fichesDir exists before parsing form\n        if (!fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(fichesDir)) {\n            fs__WEBPACK_IMPORTED_MODULE_2___default().mkdirSync(fichesDir, {\n                recursive: true\n            });\n        }\n        const form = (0,formidable__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            allowEmptyFiles: false\n        });\n        form.uploadDir = fichesDir;\n        form.keepExtensions = true;\n        form.parse(req, async (err, fields, files)=>{\n            if (err) {\n                console.error('Error parsing form:', err);\n                return res.status(500).json({\n                    error: 'Erreur lors du traitement du fichier'\n                });\n            }\n            const displayName = fields.displayName;\n            let file = files.file;\n            // If files.file is an array, use the first element\n            if (Array.isArray(file)) {\n                file = file[0];\n            }\n            console.log('Uploaded file object:', file);\n            if (!displayName || !file) {\n                return res.status(400).json({\n                    error: 'Nom d\\'affichage et fichier sont requis'\n                });\n            }\n            if (file.size === 0) {\n                return res.status(400).json({\n                    error: 'Le fichier téléchargé est vide'\n                });\n            }\n            // Move the uploaded file to the fichesDir with original filename\n            const oldPath = file.filepath || file.path;\n            if (!oldPath || typeof oldPath !== 'string') {\n                console.error('Uploaded file path is missing or invalid');\n                return res.status(400).json({\n                    error: 'Chemin du fichier téléchargé manquant ou invalide'\n                });\n            }\n            let fileName = file.originalFilename || file.name;\n            // Ensure fileName is defined, assign default if not\n            if (!fileName || typeof fileName !== 'string') {\n                fileName = 'uploaded_file';\n            }\n            // Sanitize filename by replacing invalid characters with underscore\n            fileName = fileName.replace(/[^a-zA-Z0-9.-]/g, '_');\n            const newPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(fichesDir, fileName);\n            try {\n                // Check if file with same name exists, if yes, rename with timestamp\n                let finalPath = newPath;\n                if (fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(newPath)) {\n                    const timestamp = Date.now();\n                    const ext = path__WEBPACK_IMPORTED_MODULE_3___default().extname(fileName);\n                    const baseName = path__WEBPACK_IMPORTED_MODULE_3___default().basename(fileName, ext);\n                    finalPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(fichesDir, `${baseName}-${timestamp}${ext}`);\n                }\n                await fs__WEBPACK_IMPORTED_MODULE_2___default().promises.rename(oldPath, finalPath);\n                // Store metadata in DB\n                const relativePath = path__WEBPACK_IMPORTED_MODULE_3___default().relative(process.cwd(), finalPath).replace(/\\\\/g, '/');\n                const result = await query('INSERT INTO fiches_horaires (display_name, file_path) VALUES (?, ?)', [\n                    displayName,\n                    relativePath\n                ]);\n                res.status(201).json({\n                    id: result.insertId,\n                    displayName,\n                    filePath: relativePath\n                });\n            } catch (error) {\n                console.error('Error saving file or metadata:', error.stack || error);\n                res.status(500).json({\n                    error: 'Erreur lors de l\\'enregistrement du fichier'\n                });\n            }\n        });\n    } else {\n        res.setHeader('Allow', [\n            'GET',\n            'POST'\n        ]);\n        res.status(405).end(`Méthode ${req.method} non autorisée`);\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS9maWNoZXMtaG9yYWlyZXMvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQW1DO0FBQ0M7QUFDaEI7QUFDSTtBQUVqQixNQUFNSSxTQUFTO0lBQ3BCQyxLQUFLO1FBQ0hDLFlBQVk7SUFDZDtBQUNGLEVBQUU7QUFFRixNQUFNQyxZQUFZSixnREFBUyxDQUFDTSxRQUFRQyxHQUFHLElBQUksVUFBVTtBQUVyRCxlQUFlQyxNQUFNQyxHQUFHLEVBQUVDLE1BQU07SUFDOUJDLFFBQVFDLEdBQUcsQ0FBQywwQkFBMEI7UUFDcENDLE1BQU1QLFFBQVFRLEdBQUcsQ0FBQ0MsVUFBVTtRQUM1QkMsTUFBTVYsUUFBUVEsR0FBRyxDQUFDRyxVQUFVO1FBQzVCQyxVQUFVWixRQUFRUSxHQUFHLENBQUNLLGNBQWM7SUFDdEM7SUFDQSxNQUFNQyxhQUFhLE1BQU12QixzRUFBc0IsQ0FBQztRQUM5Q2dCLE1BQU1QLFFBQVFRLEdBQUcsQ0FBQ0MsVUFBVSxJQUFJO1FBQ2hDTyxNQUFNaEIsUUFBUVEsR0FBRyxDQUFDUyxVQUFVLEdBQUdDLFNBQVNsQixRQUFRUSxHQUFHLENBQUNTLFVBQVUsSUFBSTtRQUNsRVAsTUFBTVYsUUFBUVEsR0FBRyxDQUFDRyxVQUFVO1FBQzVCUSxVQUFVbkIsUUFBUVEsR0FBRyxDQUFDWSxjQUFjO1FBQ3BDUixVQUFVWixRQUFRUSxHQUFHLENBQUNLLGNBQWM7SUFDdEM7SUFDQSxNQUFNLENBQUNRLFFBQVEsR0FBRyxNQUFNUCxXQUFXUSxPQUFPLENBQUNuQixLQUFLQztJQUNoRCxNQUFNVSxXQUFXUyxHQUFHO0lBQ3BCLE9BQU9GO0FBQ1Q7QUFFZSxlQUFlRyxRQUFRQyxHQUFHLEVBQUVDLEdBQUc7SUFDNUMsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLE9BQU87UUFDeEIsSUFBSTtZQUNGLE1BQU1OLFVBQVUsTUFBTW5CLE1BQU07WUFDNUJ3QixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxD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b0JBQUUxQjtvQkFBYTJCLFVBQVVMO2dCQUFhO1lBQ2xGLEVBQUUsT0FBT2xDLE9BQU87Z0JBQ2R6QixRQUFReUIsS0FBSyxDQUFDLGtDQUFrQ0EsTUFBTXdDLEtBQUssSUFBSXhDO2dCQUMvREosSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFBRUMsT0FBTztnQkFBOEM7WUFDOUU7UUFDRjtJQUNGLE9BQU87UUFDTEosSUFBSTZDLFNBQVMsQ0FBQyxTQUFTO1lBQUM7WUFBTztTQUFPO1FBQ3RDN0MsSUFBSUUsTUFBTSxDQUFDLEtBQUtMLEdBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRUUsSUFBSUUsTUFBTSxDQUFDLGNBQWMsQ0FBQztJQUMzRDtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvbWF0aGlzZ3JpbGxvdC9Eb2N1bWVudHMvZGXMgXZlbG9wcGVtZW50IFdFQi9UZXItR2VzdGlvbi9wYWdlcy9hcGkvZmljaGVzLWhvcmFpcmVzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBteXNxbCBmcm9tICdteXNxbDIvcHJvbWlzZSc7XG5pbXBvcnQgZm9ybWlkYWJsZSBmcm9tICdmb3JtaWRhYmxlJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgYXBpOiB7XG4gICAgYm9keVBhcnNlcjogZmFsc2UsXG4gIH0sXG59O1xuXG5jb25zdCBmaWNoZXNEaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B1YmxpYycsICdmaWNoZXMtaG9yYWlyZXMnKTtcblxuYXN5bmMgZnVuY3Rpb24gcXVlcnkoc3FsLCBwYXJhbXMpIHtcbiAgY29uc29sZS5sb2coJ0Nvbm5lY3RpbmcgdG8gREIgd2l0aDonLCB7XG4gICAgaG9zdDogcHJvY2Vzcy5lbnYuTVlTUUxfSE9TVCxcbiAgICB1c2VyOiBwcm9jZXNzLmVudi5NWVNRTF9VU0VSLFxuICAgIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcbiAgfSk7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBteXNxbC5jcmVhdGVDb25uZWN0aW9uKHtcbiAgICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NUIHx8ICcxMjcuMC4wLjEnLFxuICAgIHBvcnQ6IHByb2Nlc3MuZW52Lk1ZU1FMX1BPUlQgPyBwYXJzZUludChwcm9jZXNzLmVudi5NWVNRTF9QT1JUKSA6IDg4ODksXG4gICAgdXNlcjogcHJvY2Vzcy5lbnYuTVlTUUxfVVNFUixcbiAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuTVlTUUxfUEFTU1dPUkQsXG4gICAgZGF0YWJhc2U6IHByb2Nlc3MuZW52Lk1ZU1FMX0RBVEFCQVNFLFxuICB9KTtcbiAgY29uc3QgW3Jlc3VsdHNdID0gYXdhaXQgY29ubmVjdGlvbi5leGVjdXRlKHNxbCwgcGFyYW1zKTtcbiAgYXdhaXQgY29ubmVjdGlvbi5lbmQoKTtcbiAgcmV0dXJuIHJlc3VsdHM7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgPT09ICdHRVQnKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBxdWVyeSgnU0VMRUNUICogRlJPTSBmaWNoZXNfaG9yYWlyZXMgT1JERVIgQlkgY3JlYXRlZF9hdCBERVNDJyk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHRzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgZmljaGVzIGhvcmFpcmVzOicsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJldXIgbG9ycyBkZSBsYSByw6ljdXDDqXJhdGlvbiBkZXMgZmljaGVzIGhvcmFpcmVzJyB9KTtcbiAgICB9XG4gIH0gZWxzZSBpZiAocmVxLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgLy8gRW5zdXJlIGZpY2hlc0RpciBleGlzdHMgYmVmb3JlIHBhcnNpbmcgZm9ybVxuICAgIGlmICghZnMuZXhpc3RzU3luYyhmaWNoZXNEaXIpKSB7XG4gICAgICBmcy5ta2RpclN5bmMoZmljaGVzRGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtID0gZm9ybWlkYWJsZSh7XG4gICAgICBhbGxvd0VtcHR5RmlsZXM6IGZhbHNlLCAvLyBkaXNhbGxvdyBlbXB0eSBmaWxlcywgd2lsbCB0aHJvdyBlcnJvciBpZiBlbXB0eVxuICAgIH0pO1xuICAgIGZvcm0udXBsb2FkRGlyID0gZmljaGVzRGlyO1xuICAgIGZvcm0ua2VlcEV4dGVuc2lvbnMgPSB0cnVlO1xuXG4gICAgZm9ybS5wYXJzZShyZXEsIGFzeW5jIChlcnIsIGZpZWxkcywgZmlsZXMpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBmb3JtOicsIGVycik7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyZXVyIGxvcnMgZHUgdHJhaXRlbWVudCBkdSBmaWNoaWVyJyB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGlzcGxheU5hbWUgPSBmaWVsZHMuZGlzcGxheU5hbWU7XG4gICAgICBsZXQgZmlsZSA9IGZpbGVzLmZpbGU7XG5cbiAgICAgIC8vIElmIGZpbGVzLmZpbGUgaXMgYW4gYXJyYXksIHVzZSB0aGUgZmlyc3QgZWxlbWVudFxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsZSkpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVbMF07XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdVcGxvYWRlZCBmaWxlIG9iamVjdDonLCBmaWxlKTtcblxuICAgICAgaWYgKCFkaXNwbGF5TmFtZSB8fCAhZmlsZSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ05vbSBkXFwnYWZmaWNoYWdlIGV0IGZpY2hpZXIgc29udCByZXF1aXMnIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZmlsZS5zaXplID09PSAwKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnTGUgZmljaGllciB0w6lsw6ljaGFyZ8OpIGVzdCB2aWRlJyB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gTW92ZSB0aGUgdXBsb2FkZWQgZmlsZSB0byB0aGUgZmljaGVzRGlyIHdpdGggb3JpZ2luYWwgZmlsZW5hbWVcbiAgICAgIGNvbnN0IG9sZFBhdGggPSBmaWxlLmZpbGVwYXRoIHx8IGZpbGUucGF0aDtcblxuICAgICAgaWYgKCFvbGRQYXRoIHx8IHR5cGVvZiBvbGRQYXRoICE9PSAnc3RyaW5nJykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdVcGxvYWRlZCBmaWxlIHBhdGggaXMgbWlzc2luZyBvciBpbnZhbGlkJyk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnQ2hlbWluIGR1IGZpY2hpZXIgdMOpbMOpY2hhcmfDqSBtYW5xdWFudCBvdSBpbnZhbGlkZScgfSk7XG4gICAgICB9XG5cbiAgICAgIGxldCBmaWxlTmFtZSA9IGZpbGUub3JpZ2luYWxGaWxlbmFtZSB8fCBmaWxlLm5hbWU7XG5cbiAgICAgIC8vIEVuc3VyZSBmaWxlTmFtZSBpcyBkZWZpbmVkLCBhc3NpZ24gZGVmYXVsdCBpZiBub3RcbiAgICAgIGlmICghZmlsZU5hbWUgfHwgdHlwZW9mIGZpbGVOYW1lICE9PSAnc3RyaW5nJykge1xuICAgICAgICBmaWxlTmFtZSA9ICd1cGxvYWRlZF9maWxlJztcbiAgICAgIH1cblxuICAgICAgLy8gU2FuaXRpemUgZmlsZW5hbWUgYnkgcmVwbGFjaW5nIGludmFsaWQgY2hhcmFjdGVycyB3aXRoIHVuZGVyc2NvcmVcbiAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUucmVwbGFjZSgvW15hLXpBLVowLTkuLV0vZywgJ18nKTtcblxuICAgICAgY29uc3QgbmV3UGF0aCA9IHBhdGguam9pbihmaWNoZXNEaXIsIGZpbGVOYW1lKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgZmlsZSB3aXRoIHNhbWUgbmFtZSBleGlzdHMsIGlmIHllcywgcmVuYW1lIHdpdGggdGltZXN0YW1wXG4gICAgICAgIGxldCBmaW5hbFBhdGggPSBuZXdQYXRoO1xuICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhuZXdQYXRoKSkge1xuICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCk7XG4gICAgICAgICAgY29uc3QgZXh0ID0gcGF0aC5leHRuYW1lKGZpbGVOYW1lKTtcbiAgICAgICAgICBjb25zdCBiYXNlTmFtZSA9IHBhdGguYmFzZW5hbWUoZmlsZU5hbWUsIGV4dCk7XG4gICAgICAgICAgZmluYWxQYXRoID0gcGF0aC5qb2luKGZpY2hlc0RpciwgYCR7YmFzZU5hbWV9LSR7dGltZXN0YW1wfSR7ZXh0fWApO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgZnMucHJvbWlzZXMucmVuYW1lKG9sZFBhdGgsIGZpbmFsUGF0aCk7XG5cbiAgICAgICAgLy8gU3RvcmUgbWV0YWRhdGEgaW4gREJcbiAgICAgICAgY29uc3QgcmVsYXRpdmVQYXRoID0gcGF0aC5yZWxhdGl2ZShwcm9jZXNzLmN3ZCgpLCBmaW5hbFBhdGgpLnJlcGxhY2UoL1xcXFwvZywgJy8nKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXG4gICAgICAgICAgJ0lOU0VSVCBJTlRPIGZpY2hlc19ob3JhaXJlcyAoZGlzcGxheV9uYW1lLCBmaWxlX3BhdGgpIFZBTFVFUyAoPywgPyknLFxuICAgICAgICAgIFtkaXNwbGF5TmFtZSwgcmVsYXRpdmVQYXRoXVxuICAgICAgICApO1xuXG4gICAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHsgaWQ6IHJlc3VsdC5pbnNlcnRJZCwgZGlzcGxheU5hbWUsIGZpbGVQYXRoOiByZWxhdGl2ZVBhdGggfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgZmlsZSBvciBtZXRhZGF0YTonLCBlcnJvci5zdGFjayB8fCBlcnJvcik7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJldXIgbG9ycyBkZSBsXFwnZW5yZWdpc3RyZW1lbnQgZHUgZmljaGllcicgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ0dFVCcsICdQT1NUJ10pO1xuICAgIHJlcy5zdGF0dXMoNDA1KS5lbmQoYE3DqXRob2RlICR7cmVxLm1ldGhvZH0gbm9uIGF1dG9yaXPDqWVgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIm15c3FsIiwiZm9ybWlkYWJsZSIsImZzIiwicGF0aCIsImNvbmZpZyIsImFwaSIsImJvZHlQYXJzZXIiLCJmaWNoZXNEaXIiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsInF1ZXJ5Iiwic3FsIiwicGFyYW1zIiwiY29uc29sZSIsImxvZyIsImhvc3QiLCJlbnYiLCJNWVNRTF9IT1NUIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwiY29ubmVjdGlvbiIsImNyZWF0ZUNvbm5lY3Rpb24iLCJwb3J0IiwiTVlTUUxfUE9SVCIsInBhcnNlSW50IiwicGFzc3dvcmQiLCJNWVNRTF9QQVNTV09SRCIsInJlc3VsdHMiLCJleGVjdXRlIiwiZW5kIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJmb3JtIiwiYWxsb3dFbXB0eUZpbGVzIiwidXBsb2FkRGlyIiwia2VlcEV4dGVuc2lvbnMiLCJwYXJzZSIsImVyciIsImZpZWxkcyIsImZpbGVzIiwiZGlzcGxheU5hbWUiLCJmaWxlIiwiQXJyYXkiLCJpc0FycmF5Iiwic2l6ZSIsIm9sZFBhdGgiLCJmaWxlcGF0aCIsImZpbGVOYW1lIiwib3JpZ2luYWxGaWxlbmFtZSIsIm5hbWUiLCJyZXBsYWNlIiwibmV3UGF0aCIsImZpbmFsUGF0aCIsInRpbWVzdGFtcCIsIkRhdGUiLCJub3ciLCJleHQiLCJleHRuYW1lIiwiYmFzZU5hbWUiLCJiYXNlbmFtZSIsInByb21pc2VzIiwicmVuYW1lIiwicmVsYXRpdmVQYXRoIiwicmVsYXRpdmUiLCJyZXN1bHQiLCJpZCIsImluc2VydElkIiwiZmlsZVBhdGgiLCJzdGFjayIsInNldEhlYWRlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/fiches-horaires/index.js\n");

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffiches-horaires&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffiches-horaires%2Findex.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();