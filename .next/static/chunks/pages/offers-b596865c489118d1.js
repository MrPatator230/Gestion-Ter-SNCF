(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7997],{207:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});var i=t(7876),s=t(5448);t(7328);var r=t(6790);function n(e){let{children:a,darkMode:t,toggleDarkMode:n}=e;return(0,i.jsxs)("div",{className:"main-wrapper d-flex flex-column min-vh-100",children:[(0,i.jsx)(s.A,{darkMode:t,toggleDarkMode:n}),(0,i.jsx)("main",{className:"main-container flex-grow-1",children:(0,i.jsx)("div",{className:"container-fluid",children:a})}),(0,i.jsx)(r.A,{})]})}},503:e=>{e.exports={modalBackdrop:"modal_modalBackdrop__ct8eJ",modal:"modal_modal__9os02",modalHeader:"modal_modalHeader__tbn7w",modalTitle:"modal_modalTitle__EMDpe","btn-close":"modal_btn-close__ZiNbZ",modalBody:"modal_modalBody__FZSse",modalFooter:"modal_modalFooter__lUEMp"}},992:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/offers",function(){return t(3566)}])},3566:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>k});var i=t(7876),s=t(4250),r=t.n(s),n=t(4232),l=t(9099),d=t(207),o=t(4613),c=t(3561),m=t(7180),x=t(503),f=t.n(x),p=t(7238),u=t(3976),b=t(107);let j=e=>(0,p.GP)(new Date(e),"EEEE",{locale:b.fr}),y=e=>(0,p.GP)(new Date(e),"EEEE d MMMM yyyy",{locale:b.fr}),h=(e,a)=>{let t=(0,u.qg)(e,"HH:mm",new Date),i=(0,u.qg)(a,"HH:mm",new Date),s=60*i.getHours()+i.getMinutes()-(60*t.getHours()+t.getMinutes()),r=Math.floor(s/60);return"".concat(r,"h").concat((s%60).toString().padStart(2,"0"))};var g=t(5364);let v=e=>{if(!e)return"";let[a,t]=e.split(":");return"".concat(a,"h").concat(t)},w={lundi:"Monday",mardi:"Tuesday",mercredi:"Wednesday",jeudi:"Thursday",vendredi:"Friday",samedi:"Saturday",dimanche:"Sunday"};function k(){var e,a;let t=(0,l.useRouter)(),[s,x]=(0,n.useState)(null),[p,u]=(0,n.useState)(!0),[b,k]=(0,n.useState)(null),[N,S]=(0,n.useState)(!1),{trackAssignments:T}=(0,c.N)();(0,n.useEffect)(()=>{if(t.query.departureStation){let{departureStation:e,arrivalStation:a,viaStation:i,departureDate:s,returnDate:r}=t.query;(async()=>{try{let t=new URLSearchParams({station:e}),n=await fetch("/api/schedules/by-station?".concat(t.toString()));if(!n.ok)throw Error("Failed to fetch schedules");let l=await n.json();console.log("Fetched schedules:",l);let d=l.filter(t=>{var r;let n=t.departureStation===e||t.servedStations&&t.servedStations.some(a=>("object"==typeof a?a.name:a)===e),l=t.arrivalStation===a||t.servedStations&&t.servedStations.some(e=>("object"==typeof e?e.name:e)===a),d=!i||t.servedStations&&t.servedStations.some(e=>("object"==typeof e?e.name:e)===i),o=w[j(new Date(s)).toLowerCase()],c=null==(r=t.joursCirculation)?void 0:r.includes(o);return n&&l&&d&&c}).map(t=>{let i={...t};if(e!==t.departureStation){let a=t.servedStations.find(a=>("object"==typeof a?a.name:a)===e);a&&(i.displayDepartureTime=a.departureTime,i.displayDepartureStation=e)}else i.displayDepartureTime=t.departureTime,i.displayDepartureStation=t.departureStation;if(a!==t.arrivalStation){let e=t.servedStations.find(e=>("object"==typeof e?e.name:e)===a);e&&(i.displayArrivalTime=e.arrivalTime,i.displayArrivalStation=a)}else i.displayArrivalTime=t.arrivalTime,i.displayArrivalStation=t.arrivalStation;return i}),o=null;r&&(o=l.filter(t=>{var s;let n=t.departureStation===a||t.servedStations&&t.servedStations.some(e=>("object"==typeof e?e.name:e)===a),l=t.arrivalStation===e||t.servedStations&&t.servedStations.some(a=>("object"==typeof a?a.name:a)===e),d=!i||t.servedStations&&t.servedStations.some(e=>("object"==typeof e?e.name:e)===i),o=w[j(new Date(r)).toLowerCase()],c=null==(s=t.joursCirculation)?void 0:s.includes(o);return n&&l&&d&&c}).map(t=>{let i={...t};if(a!==t.departureStation){let e=t.servedStations.find(e=>("object"==typeof e?e.name:e)===a);e&&(i.displayDepartureTime=e.departureTime,i.displayDepartureStation=a)}else i.displayDepartureTime=t.departureTime,i.displayDepartureStation=t.departureStation;if(e!==t.arrivalStation){let a=t.servedStations.find(a=>("object"==typeof a?a.name:a)===e);a&&(i.displayArrivalTime=a.arrivalTime,i.displayArrivalStation=e)}else i.displayArrivalTime=t.arrivalTime,i.displayArrivalStation=t.arrivalStation;return i})),x({aller:{date:s,trains:d.sort((e,a)=>e.displayDepartureTime.localeCompare(a.displayDepartureTime))},retour:r?{date:r,trains:o.sort((e,a)=>e.displayDepartureTime.localeCompare(a.displayDepartureTime))}:null}),u(!1)}catch(e){console.error("Error fetching schedules:",e),u(!1)}})()}},[t.query]);let[z,_]=(0,n.useState)([]),{user:C}=(0,n.useContext)(o.c);(0,n.useEffect)(()=>{let e=localStorage.getItem("ticketTypes");e&&_(JSON.parse(e))},[]);let D=e=>{console.log("Schedule clicked:",e),console.log("Current modal state:",N),k(e),S(!0),console.log("New modal state:",!0)},M=e=>{if(console.log("handlePurchaseTicket called"),console.log("User:",C),!C){alert("Vous devez \xeatre connect\xe9 pour acheter un billet."),t.push("/login");return}if(!C.role||"client"!==C.role.toLowerCase())return void alert("Seuls les utilisateurs avec le r\xf4le Client peuvent r\xe9server un billet.");let a=z.find(e=>"Billet"===e.category);if(console.log("Ticket types:",z),console.log("Selected ticket type:",a),!a)return void alert("Aucun type de billet disponible.");let i="ticketCart_".concat(C.username||C.id);console.log("Cart key:",i);let s=JSON.parse(localStorage.getItem(i)||"[]");console.log("Current cart:",s);let r={id:Date.now().toString(),typeId:a.id,typeName:a.name,price:a.price,category:a.category,date:new Date().toISOString(),schedule:{trainNumber:e.trainNumber,trainType:e.trainType,departureStation:e.displayDepartureStation,arrivalStation:e.displayArrivalStation,departureTime:e.displayDepartureTime,arrivalTime:e.displayArrivalTime}};s.push(r),localStorage.setItem(i,JSON.stringify(s)),console.log("Updated cart:",s),alert("Billet ajout\xe9 au panier !")};return p?(0,i.jsx)(d.A,{children:(0,i.jsx)("div",{className:"container py-4",children:(0,i.jsx)("div",{className:"d-flex justify-content-center",children:(0,i.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,i.jsx)("span",{className:"visually-hidden",children:"Chargement..."})})})})}):(0,i.jsx)(d.A,{children:(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 offers-page",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 container py-4",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 journey-header mb-4",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 d-flex align-items-center mb-3",children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 material-icons text-primary me-2",children:"train"}),(0,i.jsxs)("h2",{className:"jsx-5d0d19fe734826c3 mb-0",children:[t.query.departureStation,t.query.viaStation&&(0,i.jsxs)("span",{className:"jsx-5d0d19fe734826c3 via-text",children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 material-icons",children:"arrow_forward"}),t.query.viaStation]}),(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 material-icons",children:"arrow_forward"}),t.query.arrivalStation]})]}),(0,i.jsxs)("button",{onClick:()=>t.back(),className:"jsx-5d0d19fe734826c3 btn btn-link text-primary p-0",children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 material-icons align-middle me-1",children:"arrow_back"}),"Modifier ma recherche"]})]}),s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 offers-section mb-4",children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 offers-header",children:(0,i.jsxs)("h3",{className:"jsx-5d0d19fe734826c3 h5 mb-3",children:["Trains disponibles le ",y(s.aller.date)]})}),s.aller.trains.length>0?(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 offers-list",children:s.aller.trains.map(e=>{var a;return(0,i.jsxs)("div",{onClick:()=>D(e),style:{cursor:"pointer"},className:"jsx-5d0d19fe734826c3 offer-card",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 offer-header",children:[(0,i.jsxs)("div",{style:e.isCancelled?{textDecoration:"line-through",color:"red"}:{},className:"jsx-5d0d19fe734826c3 train-info",children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 train-type",children:e.trainType}),(0,i.jsxs)("span",{className:"jsx-5d0d19fe734826c3 train-number",children:["N\xb0 ",e.trainNumber]})]}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 train-status",children:e.isCancelled?(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 badge bg-danger",children:"Supprim\xe9"}):e.delayMinutes?(0,i.jsxs)("span",{className:"jsx-5d0d19fe734826c3 badge bg-warning text-dark",children:["Retard ",e.delayMinutes," min"]}):(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 badge bg-success",children:"\xc0 l'heure"})})]}),(0,i.jsxs)("div",{style:e.isCancelled?{textDecoration:"line-through",color:"red"}:{},className:"jsx-5d0d19fe734826c3 offer-body",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 journey-times",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 departure",children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 time",children:e.isCancelled?v(e.displayDepartureTime):e.delayMinutes?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 delayed-time",children:(0,g.EU)(e.displayDepartureTime,e.delayMinutes)}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 original-time",children:v(e.displayDepartureTime)})]}):v(e.displayDepartureTime)}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 station",children:e.displayDepartureStation})]}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 journey-duration",children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 duration-line"}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 duration-time",children:h(e.displayDepartureTime,e.displayArrivalTime)})]}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 arrival",children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 time",children:e.isCancelled?v(e.displayArrivalTime):e.delayMinutes?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 delayed-time",children:(0,g.EU)(e.displayArrivalTime,e.delayMinutes)}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 original-time",children:v(e.displayArrivalTime)})]}):v(e.displayArrivalTime)}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 station",children:e.displayArrivalStation})]})]}),e.servedStations&&e.servedStations.length>0&&(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 via-stations",children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 material-icons",children:"route"}),"Gares desservies : ",e.servedStations.map(e=>e.name).join(", ")]}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 quai-display mt-2",children:["Quai: ",(null==(a=T[e.id])?void 0:a[e.displayDepartureStation])||"-"]})]}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 offer-actions",children:(0,i.jsx)("button",{disabled:e.isCancelled,onClick:a=>{a.stopPropagation(),M(e)},className:"jsx-5d0d19fe734826c3 "+"btn ".concat(e.isCancelled?"btn-secondary disabled":"btn-primary"),children:"Acheter un billet"})})]},e.id)})}):(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 alert alert-info",children:"Aucun train ne circule ce jour."})]}),s.retour&&(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 offers-section",children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 offers-header",children:(0,i.jsxs)("h3",{className:"jsx-5d0d19fe734826c3 h5 mb-3",children:["Trains disponibles le ",y(s.retour.date)]})}),s.retour.trains.length>0?(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 offers-list",children:s.retour.trains.map(e=>(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 offer-card",children:[(0,i.jsxs)("div",{onClick:()=>D(e),style:{cursor:"pointer"},className:"jsx-5d0d19fe734826c3 offer-header",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 train-info",children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 train-type",children:e.trainType}),(0,i.jsxs)("span",{className:"jsx-5d0d19fe734826c3 train-number",children:["N\xb0 ",e.trainNumber]})]}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 train-status",children:(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 badge bg-success",children:"\xc0 l'heure"})})]}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 offer-body",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 journey-times",children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 departure",children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 time",children:e.displayDepartureTime}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 station",children:e.displayDepartureStation})]}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 journey-duration",children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 duration-line"}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 duration-time",children:h(e.displayDepartureTime,e.displayArrivalTime)})]}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 arrival",children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 time",children:e.displayArrivalTime}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 station",children:e.displayArrivalStation})]})]}),e.servedStations&&e.servedStations.length>0&&(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 via-stations",children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 material-icons",children:"route"}),"Gares desservies : ",e.servedStations.map(e=>e.name).join(", ")]})]}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 offer-actions",children:(0,i.jsx)("button",{onClick:a=>{a.stopPropagation(),M(e)},className:"jsx-5d0d19fe734826c3 btn btn-primary btn-sm",children:"Acheter un billet"})})]},e.id))}):(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 alert alert-info",children:"Aucun train ne circule ce jour."})]})]}),N&&b&&(0,i.jsx)("div",{onClick:e=>{e.target===e.currentTarget&&S(!1)},className:"jsx-5d0d19fe734826c3 "+(f().modalOverlay||""),children:(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationsModal||""),children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationsModalHeader||""),children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3",children:[(0,i.jsx)("h3",{className:"jsx-5d0d19fe734826c3",children:"Liste des gares"}),(0,i.jsxs)("p",{className:"jsx-5d0d19fe734826c3",children:["desservies par le train ",b.trainType," ",b.trainNumber]}),(0,i.jsxs)("p",{className:"jsx-5d0d19fe734826c3",children:["Op\xe9r\xe9 par SNCF Voyageurs - ",b.trainNumber]})]}),(0,i.jsx)("button",{onClick:()=>S(!1),className:"jsx-5d0d19fe734826c3 "+(f().closeButton||""),children:"\xd7"})]}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationsModalContent||""),children:[b.composition&&b.composition.length>0&&(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 mb-4",children:(0,i.jsx)(m.A,{trainNumber:b.trainNumber,composition:b.composition})}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationsGrid||""),children:[(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationsHeader||""),children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3",children:"D\xe9part"}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3",children:"Gare"}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3",children:"Voie"})]}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationRow||""),children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationTime||""),children:b.departureTime}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationName||""),children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 "+(f().stationDot||"")}),b.departureStation]}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationTrack||""),children:(null==(e=T[b.id])?void 0:e[b.departureStation])||"-"})]}),b.servedStations&&b.servedStations.map((e,a)=>{var t;let s="object"==typeof e?e.name:e,r="object"==typeof e?e.departureTime:null,n=(null==(t=T[b.id])?void 0:t[s])||"-";return(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationRow||""),children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationTime||""),children:r||"-"}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationName||""),children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 "+(f().stationDot||"")}),s]}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationTrack||""),children:n})]},a)}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationRow||""),children:[(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationTime||""),children:b.arrivalTime}),(0,i.jsxs)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationName||""),children:[(0,i.jsx)("span",{className:"jsx-5d0d19fe734826c3 "+(f().stationDot||"")}),b.arrivalStation]}),(0,i.jsx)("div",{className:"jsx-5d0d19fe734826c3 "+(f().stationTrack||""),children:(null==(a=T[b.id])?void 0:a[b.arrivalStation])||"-"})]})]})]})]})})]}),(0,i.jsx)(r(),{id:"5d0d19fe734826c3",children:'.offers-page.jsx-5d0d19fe734826c3{background-color:#f8f9fa;min-height:-webkit-calc(100vh - 64px);min-height:-moz-calc(100vh - 64px);min-height:calc(100vh - 64px)}.journey-header.jsx-5d0d19fe734826c3 h2.jsx-5d0d19fe734826c3{color:#006;font-size:1.5rem;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:.5rem}.via-text.jsx-5d0d19fe734826c3{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:.5rem;color:#666}.offers-section.jsx-5d0d19fe734826c3{background:white;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;padding:1.5rem;-webkit-box-shadow:0 2px 4px rgba(0,0,0,.1);-moz-box-shadow:0 2px 4px rgba(0,0,0,.1);box-shadow:0 2px 4px rgba(0,0,0,.1)}.offers-list.jsx-5d0d19fe734826c3{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:1rem}.offer-card.jsx-5d0d19fe734826c3{border:1px solid#dee2e6;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;overflow:hidden;-webkit-transition:-webkit-transform.2s;-moz-transition:-moz-transform.2s;-o-transition:-o-transform.2s;transition:-webkit-transform.2s;transition:-moz-transform.2s;transition:-o-transform.2s;transition:transform.2s}.offer-card.jsx-5d0d19fe734826c3:hover{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px);-webkit-box-shadow:0 4px 8px rgba(0,0,0,.1);-moz-box-shadow:0 4px 8px rgba(0,0,0,.1);box-shadow:0 4px 8px rgba(0,0,0,.1)}.offer-header.jsx-5d0d19fe734826c3{background:#f8f9fa;padding:1rem;border-bottom:1px solid#dee2e6;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.train-info.jsx-5d0d19fe734826c3{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:1rem}.train-type.jsx-5d0d19fe734826c3{font-weight:600;color:#006}.train-number.jsx-5d0d19fe734826c3{color:#666}.offer-body.jsx-5d0d19fe734826c3{padding:1.5rem}.journey-times.jsx-5d0d19fe734826c3{display:grid;grid-template-columns:auto 1fr auto;gap:2rem;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:1rem}.departure.jsx-5d0d19fe734826c3,.arrival.jsx-5d0d19fe734826c3{text-align:center}.time.jsx-5d0d19fe734826c3{font-weight:600;color:#006;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.delayed-time.jsx-5d0d19fe734826c3{color:#fd7e14;font-weight:600;font-size:1rem}.original-time.jsx-5d0d19fe734826c3{text-decoration:line-through;color:#666;font-size:.7rem;margin-top:2px}.badge.bg-warning.jsx-5d0d19fe734826c3{background-color:#fd7e14!important;color:white!important}.station.jsx-5d0d19fe734826c3{color:#666;font-size:.875rem}.journey-duration.jsx-5d0d19fe734826c3{position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.duration-line.jsx-5d0d19fe734826c3{position:absolute;top:50%;left:0;right:0;height:2px;background:#dee2e6;z-index:1}.duration-time.jsx-5d0d19fe734826c3{background:white;padding:.25rem .75rem;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;font-size:.875rem;color:#666;position:relative;z-index:2}.via-stations.jsx-5d0d19fe734826c3{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:.5rem;color:#666;font-size:.875rem;margin-bottom:.5rem;padding-bottom:.5rem;border-bottom:1px solid#dee2e6}.via-stations.jsx-5d0d19fe734826c3 .material-icons.jsx-5d0d19fe734826c3{font-size:1rem;color:#0F8548}.stations-list.jsx-5d0d19fe734826c3{position:relative;padding:1rem}.station-row.jsx-5d0d19fe734826c3{display:grid;grid-template-columns:100px 1fr 80px;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:.5rem 0;position:relative}.station-row.header.jsx-5d0d19fe734826c3{font-weight:600;margin-bottom:1rem}.station.jsx-5d0d19fe734826c3{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:1rem;position:relative}.station-dot.jsx-5d0d19fe734826c3{width:12px;height:12px;background-color:#ffd700;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;position:relative;z-index:2}.stations-list.jsx-5d0d19fe734826c3::before{content:"";position:absolute;top:4rem;bottom:2rem;left:-webkit-calc(100px + 1rem + 6px);left:-moz-calc(100px + 1rem + 6px);left:calc(100px + 1rem + 6px);width:2px;background-color:#ffd700;z-index:1}.time.jsx-5d0d19fe734826c3{font-weight:600;color:#006}.track.jsx-5d0d19fe734826c3{text-align:center}.modal-content.jsx-5d0d19fe734826c3{-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;overflow:hidden}.modal-header.jsx-5d0d19fe734826c3{background-color:white;border-bottom:none}.offer-actions.jsx-5d0d19fe734826c3{padding:1rem;border-top:1px solid#dee2e6;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.modal-body.jsx-5d0d19fe734826c3{padding:2rem}@media(max-width:768px){.journey-times.jsx-5d0d19fe734826c3{grid-template-columns:1fr;gap:1rem}.journey-duration.jsx-5d0d19fe734826c3{display:none}.journey-header.jsx-5d0d19fe734826c3 h2.jsx-5d0d19fe734826c3{font-size:1.25rem}}'})]})})}},5364:(e,a,t)=>{"use strict";t.d(a,{$t:()=>d,Ag:()=>c,Cy:()=>o,EU:()=>n,Ix:()=>f,JS:()=>l,Kg:()=>p,Os:()=>i,TP:()=>x,oP:()=>m});let i=()=>JSON.parse(localStorage.getItem("schedules")||"[]"),s=e=>e&&e.trainNumber&&e.departureStation&&e.arrivalStation&&e.departureTime&&e.arrivalTime,r=e=>{let a;if(!e)return[];if("string"==typeof e)try{a=JSON.parse(e)}catch(e){return console.error("Failed to parse servedStations",e),[]}else a=e;return Array.isArray(a)?a.map(e=>"string"==typeof e?{name:e,arrivalTime:null,departureTime:null}:e).filter(e=>e&&e.name):[]},n=(e,a)=>{if(!e||!a)return e;let[t,i]=e.split(":").map(Number),s=60*t+i+a,r=Math.floor(s/60)%24;return"".concat(String(r).padStart(2,"0"),":").concat(String(s%60).padStart(2,"0"))},l=e=>e.isCancelled?{status:"cancelled",label:"Train supprim\xe9",className:"status-cancelled"}:e.delayMinutes?{status:"delayed",label:"Retard ".concat(e.delayMinutes," min"),className:"status-delayed",delayedTime:n(e.departureTime,e.delayMinutes)}:{status:"ontime",label:"\xc0 l'heure",className:"status-ontime"},d=e=>{try{if(!e)return[];return i().filter(s).filter(a=>a.departureStation===e||a.arrivalStation===e||r(a.servedStations).some(a=>a.name===e))}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration des horaires:",e),[]}},o=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departure",i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(!e||!a)return null;try{if("departure"===t){if(e.departureStation===a)return e.isCancelled?e.departureTime:i&&e.delayMinutes?n(e.departureTime,e.delayMinutes):e.departureTime;let t=r(e.servedStations).find(e=>e.name===a);if(!t)return null;return i&&e.delayMinutes&&t.departureTime?n(t.departureTime,e.delayMinutes):t.departureTime||null}{if(e.arrivalStation===a)return e.isCancelled?e.arrivalTime:i&&e.delayMinutes?n(e.arrivalTime,e.delayMinutes):e.arrivalTime;let t=r(e.servedStations).find(e=>e.name===a);if(!t)return null;return i&&e.delayMinutes&&t.arrivalTime?n(t.arrivalTime,e.delayMinutes):t.arrivalTime||null}}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration de l'heure:",e),null}},c=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departures";if(!e||!a)return[];try{return e.filter(e=>!!s(e)&&("departures"===t?e.departureStation===a||r(e.servedStations).some(e=>e.name===a&&e.departureTime):e.arrivalStation===a||r(e.servedStations).some(e=>e.name===a&&e.arrivalTime)))}catch(e){return console.error("Erreur lors du filtrage des horaires:",e),[]}},m=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departures";if(!e||!a)return"";try{if("departures"===t){if(e.departureStation===a)return e.arrivalStation;let t=r(e.servedStations),i=t.findIndex(e=>e.name===a);if(-1!==i&&i<t.length-1)return t[i+1].name;return e.arrivalStation}{if(e.arrivalStation===a)return e.departureStation;let t=r(e.servedStations),i=t.findIndex(e=>e.name===a);if(i>0)return t[i-1].name;return e.departureStation}}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration de la destination/provenance:",e),""}},x=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departures";if(!e||!a)return[];try{return[...e].sort((e,i)=>{let s=o(e,a,"departures"===t?"departure":"arrival")||"",r=o(i,a,"departures"===t?"departure":"arrival")||"";return s.localeCompare(r)})}catch(a){return console.error("Erreur lors du tri des horaires:",a),e}},f=e=>{let a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t=a.indexOf(e);return -1===t?null:a[(t+1)%a.length]},p=(e,a)=>e&&a?e.filter(e=>!e.joursCirculation||0===e.joursCirculation.length||e.joursCirculation.includes(a)):[]},7180:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});var i=t(7876),s=t(4250),r=t.n(s),n=t(4232);function l(e){let{trainNumber:a,composition:t,visualHeight:s=300}=e,[l,d]=(0,n.useState)(0),[o,c]=(0,n.useState)(!0),m=(0,n.useCallback)(()=>{(null==t?void 0:t.length)>1&&d(e=>(e+1)%t.length)},[null==t?void 0:t.length]);return((0,n.useEffect)(()=>{let e;return o&&(null==t?void 0:t.length)>1&&(e=setInterval(m,3e3)),()=>{e&&clearInterval(e)}},[o,m,null==t?void 0:t.length]),t&&0!==t.length)?(0,i.jsxs)("div",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" train-visual-slider",children:[(0,i.jsxs)("div",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" train-visual-container",children:[t.length>1&&(0,i.jsx)("button",{onClick:()=>{c(!1),d(e=>0===e?t.length-1:e-1)},className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" nav-arrow prev",children:"←"}),(0,i.jsx)("div",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" train-visual-wrapper",children:(0,i.jsx)("div",{style:{transform:"translateX(-".concat(l*(100/t.length),"%)"),width:"".concat(100*t.length,"%")},className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" train-composition",children:t.map((e,n)=>(0,i.jsxs)("div",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" train-unit",children:[(0,i.jsx)("img",{src:e.imageData,alt:"Train ".concat(a," - Unit\xe9 ").concat(n+1),onError:e=>{e.target.onerror=null,e.target.src="/images/train-placeholder.png"},className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" train-visual-image"}),(0,i.jsxs)("div",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" train-info-overlay",children:[(0,i.jsxs)("div",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" train-name",children:["Train ",a," - Unit\xe9 ",n+1]}),(0,i.jsxs)("div",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" materiel-info",children:[(0,i.jsx)("span",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" materiel-name",children:e.name}),(0,i.jsx)("span",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" materiel-type",children:e.type})]})]})]},n))})}),t.length>1&&(0,i.jsx)("button",{onClick:()=>{c(!1),m()},className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" nav-arrow next",children:"→"}),t.length>1&&(0,i.jsx)("div",{className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" slider-indicators",children:t.map((e,a)=>(0,i.jsx)("button",{onClick:()=>{c(!1),d(a)},className:r().dynamic([["28eb7567fb6d119f",[s,100/t.length,100/t.length]]])+" "+"indicator ".concat(a===l?"active":"")},a))})]}),(0,i.jsx)(r(),{id:"28eb7567fb6d119f",dynamic:[s,100/t.length,100/t.length],children:".train-visual-slider.__jsx-style-dynamic-selector{position:relative;width:100%;max-width:800px;margin:0 auto;background:#fff;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;overflow:hidden}.train-visual-container.__jsx-style-dynamic-selector{position:relative;width:100%;height:".concat(s,"px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.train-visual-wrapper.__jsx-style-dynamic-selector{position:relative;width:100%;height:100%;overflow:hidden}.train-composition.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;height:100%;-webkit-transition:-webkit-transform.5s ease;-moz-transition:-moz-transform.5s ease;-o-transition:-o-transform.5s ease;transition:-webkit-transform.5s ease;transition:-moz-transform.5s ease;transition:-o-transform.5s ease;transition:transform.5s ease}.train-unit.__jsx-style-dynamic-selector{position:relative;-webkit-box-flex:0;-webkit-flex:0 0 ").concat(100/t.length,"%;-moz-box-flex:0;-ms-flex:0 0 ").concat(100/t.length,"%;flex:0 0 ").concat(100/t.length,"%;width:").concat(100/t.length,"%;height:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.train-visual-image.__jsx-style-dynamic-selector{height:80%;width:auto;max-width:90%;-o-object-fit:contain;object-fit:contain}.train-info-overlay.__jsx-style-dynamic-selector{position:absolute;bottom:0;left:0;right:0;background:rgba(0,0,102,.8);color:white;padding:.75rem}.train-name.__jsx-style-dynamic-selector{font-weight:600;font-size:1.1rem;margin-bottom:.25rem}.materiel-info.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;font-size:.9rem;opacity:.9}.nav-arrow.__jsx-style-dynamic-selector{position:absolute;top:50%;-webkit-transform:translatey(-50%);-moz-transform:translatey(-50%);-ms-transform:translatey(-50%);-o-transform:translatey(-50%);transform:translatey(-50%);z-index:2;background:none;border:none;color:black;font-size:24px;cursor:pointer;padding:10px;-webkit-transition:opacity.2s;-moz-transition:opacity.2s;-o-transition:opacity.2s;transition:opacity.2s}.nav-arrow.__jsx-style-dynamic-selector:hover{opacity:.7}.nav-arrow.prev.__jsx-style-dynamic-selector{left:0}.nav-arrow.next.__jsx-style-dynamic-selector{right:0}.slider-indicators.__jsx-style-dynamic-selector{position:absolute;bottom:60px;left:0;right:0;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:8px;z-index:3}.indicator.__jsx-style-dynamic-selector{width:8px;height:8px;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;background:rgba(255,255,255,.5);border:none;padding:0;cursor:pointer;-webkit-transition:all.2s ease;-moz-transition:all.2s ease;-o-transition:all.2s ease;transition:all.2s ease}.indicator.active.__jsx-style-dynamic-selector{background:white;-webkit-transform:scale(1.2);-moz-transform:scale(1.2);-ms-transform:scale(1.2);-o-transform:scale(1.2);transform:scale(1.2)}.train-visual-placeholder.__jsx-style-dynamic-selector{width:100%;height:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;background:#f8f9fa;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;color:#666}.train-visual-placeholder.__jsx-style-dynamic-selector .material-icons.__jsx-style-dynamic-selector{font-size:48px;margin-bottom:1rem;color:#006}@media(max-width:768px){.nav-button.__jsx-style-dynamic-selector{width:32px;height:32px}.train-info-overlay.__jsx-style-dynamic-selector{padding:.5rem}.train-name.__jsx-style-dynamic-selector{font-size:1rem}.materiel-info.__jsx-style-dynamic-selector{font-size:.8rem}}")})]}):(0,i.jsxs)("div",{className:"train-visual-placeholder",style:{height:s},children:[(0,i.jsx)("span",{className:"material-icons",children:"train"}),(0,i.jsxs)("p",{children:["Composition non d\xe9finie pour le train ",a]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[8585,8230,4587,9319,6509,327,636,6593,8792],()=>a(992)),_N_E=e.O()}]);