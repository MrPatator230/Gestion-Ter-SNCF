(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8886],{207:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});var a=t(7876),i=t(5448);t(7328);var n=t(6790);function s(e){let{children:r,darkMode:t,toggleDarkMode:s}=e;return(0,a.jsxs)("div",{className:"main-wrapper d-flex flex-column min-vh-100",children:[(0,a.jsx)(i.A,{darkMode:t,toggleDarkMode:s}),(0,a.jsx)("main",{className:"main-container flex-grow-1",children:(0,a.jsx)("div",{className:"container-fluid",children:r})}),(0,a.jsx)(n.A,{})]})}},3492:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/fiches-horaires",function(){return t(8977)}])},3620:(e,r,t)=>{"use strict";t.d(r,{k5:()=>u});var a=t(4232),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=a.createContext&&a.createContext(i),s=["attr","size","title"];function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}function c(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,a)}return t}function o(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?c(Object(t),!0).forEach(function(r){var a,i,n;a=e,i=r,n=t[r],(i=function(e){var r=function(e,r){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,r||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:r+""}(i))in a?Object.defineProperty(a,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[i]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function u(e){return r=>a.createElement(f,l({attr:o({},e.attr)},r),function e(r){return r&&r.map((r,t)=>a.createElement(r.tag,o({key:t},r.attr),e(r.child)))}(e.child))}function f(e){var r=r=>{var t,{attr:i,size:n,title:c}=e,u=function(e,r){if(null==e)return{};var t,a,i=function(e,r){if(null==e)return{};var t={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(r.indexOf(a)>=0)continue;t[a]=e[a]}return t}(e,r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)t=n[a],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}(e,s),f=n||r.size||"1em";return r.className&&(t=r.className),e.className&&(t=(t?t+" ":"")+e.className),a.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,u,{className:t,style:o(o({color:e.color||r.color},r.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),c&&a.createElement("title",null,c),e.children)};return void 0!==n?a.createElement(n.Consumer,null,e=>r(e)):r(i)}},8977:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});var a=t(7876),i=t(4232),n=t(207);function s(){let[e,r]=(0,i.useState)([]),[t,s]=(0,i.useState)(""),[l,c]=(0,i.useState)(null),[o,u]=(0,i.useState)(!1),[f,p]=(0,i.useState)(null);(0,i.useEffect)(()=>{d()},[]);let d=async()=>{try{let e=await fetch("/api/fiches-horaires");if(!e.ok)throw Error("Erreur lors du chargement des fiches horaires");let t=await e.json();r(t),p(null)}catch(e){p({type:"error",text:e.message})}},h=async e=>{if(e.preventDefault(),!t||!l)return void p({type:"error",text:"Veuillez fournir un nom d'affichage et un fichier PDF."});u(!0),p(null);let r=new FormData;r.append("displayName",t),r.append("file",l);try{let e=await fetch("/api/fiches-horaires",{method:"POST",body:r});if(!e.ok){let r=await e.json();throw Error(r.error||"Erreur lors de l'upload")}s(""),c(null),await d(),p({type:"success",text:"Fiche horaire ajout\xe9e avec succ\xe8s."})}catch(e){p({type:"error",text:e.message})}finally{u(!1)}},m=async e=>{if(confirm("Voulez-vous vraiment supprimer cette fiche horaire ?"))try{if(!(await fetch("/api/fiches-horaires/".concat(e),{method:"DELETE"})).ok)throw Error("Erreur lors de la suppression");await d(),p({type:"success",text:"Fiche horaire supprim\xe9e avec succ\xe8s."})}catch(e){p({type:"error",text:e.message})}};return(0,a.jsx)(n.A,{children:(0,a.jsxs)("div",{className:"container py-4",style:{maxWidth:"700px"},children:[(0,a.jsx)("h1",{children:"Gestion des Fiches Horaires"}),f&&(0,a.jsx)("div",{className:"alert ".concat("success"===f.type?"alert-success":"alert-danger"),role:"alert",children:f.text}),(0,a.jsxs)("form",{onSubmit:h,className:"mb-4",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{htmlFor:"displayName",className:"form-label",children:"Nom d'affichage"}),(0,a.jsx)("input",{type:"text",id:"displayName",className:"form-control",value:t,onChange:e=>s(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{htmlFor:"file",className:"form-label",children:"Fichier PDF"}),(0,a.jsx)("input",{type:"file",id:"file",className:"form-control",accept:"application/pdf,.pdf",onChange:e=>{c(e.target.files[0])},required:!0})]}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Chargement...":"Ajouter la fiche horaire"})]}),(0,a.jsx)("h2",{children:"Fiches Horaires existantes"}),0===e.length?(0,a.jsx)("p",{children:"Aucune fiche horaire disponible."}):(0,a.jsx)("ul",{className:"list-group",children:e.map(e=>(0,a.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[(0,a.jsx)("span",{children:e.display_name}),(0,a.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>m(e.id),children:"Supprimer"})]},e.id))})]})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[8585,8230,4587,327,636,6593,8792],()=>r(3492)),_N_E=e.O()}]);