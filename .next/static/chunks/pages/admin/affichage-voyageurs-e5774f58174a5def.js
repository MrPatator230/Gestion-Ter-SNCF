(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9142],{207:(e,r,t)=>{"use strict";t.d(r,{A:()=>n});var a=t(7876),i=t(5448);t(7328);var s=t(6790);function n(e){let{children:r,darkMode:t,toggleDarkMode:n}=e;return(0,a.jsxs)("div",{className:"main-wrapper d-flex flex-column min-vh-100",children:[(0,a.jsx)(i.A,{darkMode:t,toggleDarkMode:n}),(0,a.jsx)("main",{className:"main-container flex-grow-1",children:(0,a.jsx)("div",{className:"container-fluid",children:r})}),(0,a.jsx)(s.A,{})]})}},3377:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var a=t(7876),i=t(4232),s=t(9099),n=t(207),l=t(3779),o=t(5364);function d(){(0,s.useRouter)();let[e,r]=(0,i.useState)(""),[t,d]=(0,i.useState)(1),[c,u]=(0,i.useState)([]),[m,p]=(0,i.useState)(""),[b,h]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e=localStorage.getItem("stations");e&&u(JSON.parse(e))},[]),(0,i.useEffect)(()=>{if(m&&e){let r=(0,o.$t)(m),t=(0,o.Ag)(r,m,e);h((0,o.TP)(t,m,e))}else h([])},[m,e]);let x=m&&e?"/afficheurs?type=".concat(e,"&gare=").concat(encodeURIComponent(m)):null;return(0,a.jsx)(n.A,{children:(0,a.jsxs)("div",{id:"wrapper",style:{display:"flex",minHeight:"100vh"},children:[(0,a.jsx)(l.A,{}),(0,a.jsx)("div",{id:"content-wrapper",className:"d-flex flex-column flex-grow-1",children:(0,a.jsxs)("div",{id:"content",className:"container mt-4 flex-grow-1",children:[(0,a.jsx)("h1",{children:"Affichage Voyageurs - Admin"}),1===t&&(0,a.jsxs)("form",{onSubmit:r=>{r.preventDefault(),e&&d(2)},className:"mb-4",children:[(0,a.jsxs)("div",{className:"form-group mb-3",children:[(0,a.jsx)("label",{htmlFor:"displayType",children:"Type de tableau d'affichage"}),(0,a.jsxs)("select",{id:"displayType",className:"form-control",value:e,onChange:e=>r(e.target.value),required:!0,children:[(0,a.jsx)("option",{value:"",children:"-- Choisir --"}),(0,a.jsx)("option",{value:"departures",children:"D\xe9parts"}),(0,a.jsx)("option",{value:"arrivals",children:"Arriv\xe9es"})]})]}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Valider"})]}),2===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{htmlFor:"stationSelect",children:"Choisir une gare"}),(0,a.jsxs)("select",{id:"stationSelect",className:"form-control",value:m,onChange:e=>{p(e.target.value)},required:!0,children:[(0,a.jsx)("option",{value:"",children:"-- Choisir une gare --"}),c.map((e,r)=>(0,a.jsx)("option",{value:e.name,children:e.name},r))]})]}),m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("h2",{children:["Horaires ","departures"===e?"des d\xe9parts":"des arriv\xe9es"," - ",m]}),0===b.length?(0,a.jsx)("p",{children:"Aucun horaire trouv\xe9 pour cette gare."}):(0,a.jsxs)("table",{className:"table table-striped",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Heure"}),(0,a.jsx)("th",{children:"Destination"}),(0,a.jsx)("th",{children:"Train"}),(0,a.jsx)("th",{children:"Quai"}),(0,a.jsx)("th",{children:"Statut"})]})}),(0,a.jsx)("tbody",{children:b.map(r=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"departures"===e?r.departureTime:r.arrivalTime}),(0,a.jsx)("td",{children:"departures"===e?r.arrivalStation:r.departureStation}),(0,a.jsx)("td",{children:r.trainNumber}),(0,a.jsx)("td",{children:r.track||"-"}),(0,a.jsx)("td",{children:r.status||"\xc0 l'heure"})]},r.id))})]}),(0,a.jsxs)("p",{children:["URL publique: "," ",(0,a.jsx)("a",{href:x,target:"_blank",rel:"noopener noreferrer",children:x})]})]})]})]})})]})})}t(3874)},3874:(e,r,t)=>{"use strict";t.d(r,{A:()=>d});var a=t(7876),i=t(4250),s=t.n(i),n=t(4232),l=t(9099);let o=()=>JSON.parse(localStorage.getItem("stations")||"[]");function d(e){let{searchQuery:r,setSearchQuery:t}=e,[i,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)(-1),b=(0,l.useRouter)(),h=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let x=e=>{t(e),u(!1),b.push("/horaires-par-gare/".concat(encodeURIComponent(e)))};return(0,a.jsxs)("div",{ref:h,className:"jsx-9c78709bb41de5fc station-search",children:[(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r&&b.push("/horaires-par-gare/".concat(encodeURIComponent(r)))},className:"jsx-9c78709bb41de5fc d-flex align-items-center",children:[(0,a.jsxs)("div",{className:"jsx-9c78709bb41de5fc form-control-container w-100",children:[(0,a.jsx)("label",{htmlFor:"station",className:"jsx-9c78709bb41de5fc form-label",children:"Rechercher une gare"}),(0,a.jsxs)("div",{className:"jsx-9c78709bb41de5fc input-group",children:[(0,a.jsx)("div",{className:"jsx-9c78709bb41de5fc input-group-prepend",children:(0,a.jsx)("span",{className:"jsx-9c78709bb41de5fc input-group-text",children:(0,a.jsx)("i",{"aria-hidden":"true",className:"jsx-9c78709bb41de5fc icons-search"})})}),(0,a.jsx)("input",{type:"text",id:"station",value:r,onChange:e=>{let r=e.target.value;t(r),r.length>=2?(d(o().filter(e=>e.name.toLowerCase().includes(r.toLowerCase())).slice(0,5)),u(!0)):(d([]),u(!1)),p(-1)},onKeyDown:e=>{"ArrowDown"===e.key?(e.preventDefault(),p(e=>e<i.length-1?e+1:e)):"ArrowUp"===e.key?(e.preventDefault(),p(e=>e>0?e-1:e)):"Enter"===e.key&&m>=0&&(e.preventDefault(),x(i[m].name))},placeholder:"Saisissez le nom d'une gare...",autoComplete:"off","aria-label":"Rechercher une gare",className:"jsx-9c78709bb41de5fc form-control"})]}),c&&i.length>0&&(0,a.jsx)("div",{className:"jsx-9c78709bb41de5fc suggestions-container",children:(0,a.jsx)("div",{className:"jsx-9c78709bb41de5fc list-group",children:i.map((e,r)=>(0,a.jsxs)("button",{type:"button",onClick:()=>x(e.name),className:"jsx-9c78709bb41de5fc "+"list-group-item list-group-item-action ".concat(r===m?"active":""),children:[(0,a.jsx)("i",{"aria-hidden":"true",className:"jsx-9c78709bb41de5fc icons-station icons-size-1x5 mr-2"}),e.name,e.categories&&e.categories.length>0&&(0,a.jsx)("div",{className:"jsx-9c78709bb41de5fc station-categories",children:e.categories.map(e=>(0,a.jsx)("span",{className:"jsx-9c78709bb41de5fc badge badge-light ml-1",children:e},e))})]},e.name))})})]}),(0,a.jsxs)("button",{type:"submit",className:"jsx-9c78709bb41de5fc btn btn-primary ml-3",children:[(0,a.jsx)("i",{"aria-hidden":"true",className:"jsx-9c78709bb41de5fc icons-search icons-size-1x5"}),(0,a.jsx)("span",{className:"jsx-9c78709bb41de5fc ml-2",children:"Rechercher"})]})]}),(0,a.jsx)(s(),{id:"9c78709bb41de5fc",children:".station-search.jsx-9c78709bb41de5fc{position:relative;width:100%;max-width:600px;margin:0 auto}.suggestions-container.jsx-9c78709bb41de5fc{position:absolute;top:100%;left:0;right:0;z-index:1000;margin-top:.5rem;background:white;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;-webkit-box-shadow:0 2px 4px rgba(0,0,0,.1);-moz-box-shadow:0 2px 4px rgba(0,0,0,.1);box-shadow:0 2px 4px rgba(0,0,0,.1)}.list-group-item.jsx-9c78709bb41de5fc{border-left:none;border-right:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:.75rem 1rem}.list-group-item.jsx-9c78709bb41de5fc:first-child{-webkit-border-top-left-radius:4px;-moz-border-radius-topleft:4px;border-top-left-radius:4px;-webkit-border-top-right-radius:4px;-moz-border-radius-topright:4px;border-top-right-radius:4px}.list-group-item.jsx-9c78709bb41de5fc:last-child{-webkit-border-bottom-left-radius:4px;-moz-border-radius-bottomleft:4px;border-bottom-left-radius:4px;-webkit-border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;border-bottom-right-radius:4px}.list-group-item.active.jsx-9c78709bb41de5fc{background-color:#f8f9fa;border-color:#ddd;color:#000}.input-group-text.jsx-9c78709bb41de5fc{background-color:white;border-right:none}.form-control.jsx-9c78709bb41de5fc{border-left:none}.form-control.jsx-9c78709bb41de5fc:focus{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;border-color:#ddd}.input-group-text.jsx-9c78709bb41de5fc i.jsx-9c78709bb41de5fc{color:#666}.station-categories.jsx-9c78709bb41de5fc{margin-left:auto;font-size:.875rem}.badge.jsx-9c78709bb41de5fc{font-weight:normal}.icons-size-1x5.jsx-9c78709bb41de5fc{font-size:1.5rem;vertical-align:middle}"})]})}},5364:(e,r,t)=>{"use strict";t.d(r,{$t:()=>o,Ag:()=>c,Cy:()=>d,EU:()=>n,Ix:()=>p,JS:()=>l,Kg:()=>b,Os:()=>a,TP:()=>m,oP:()=>u});let a=()=>JSON.parse(localStorage.getItem("schedules")||"[]"),i=e=>e&&e.trainNumber&&e.departureStation&&e.arrivalStation&&e.departureTime&&e.arrivalTime,s=e=>{let r;if(!e)return[];if("string"==typeof e)try{r=JSON.parse(e)}catch(e){return console.error("Failed to parse servedStations",e),[]}else r=e;return Array.isArray(r)?r.map(e=>"string"==typeof e?{name:e,arrivalTime:null,departureTime:null}:e).filter(e=>e&&e.name):[]},n=(e,r)=>{if(!e||!r)return e;let[t,a]=e.split(":").map(Number),i=60*t+a+r,s=Math.floor(i/60)%24;return"".concat(String(s).padStart(2,"0"),":").concat(String(i%60).padStart(2,"0"))},l=e=>e.isCancelled?{status:"cancelled",label:"Train supprim\xe9",className:"status-cancelled"}:e.delayMinutes?{status:"delayed",label:"Retard ".concat(e.delayMinutes," min"),className:"status-delayed",delayedTime:n(e.departureTime,e.delayMinutes)}:{status:"ontime",label:"\xc0 l'heure",className:"status-ontime"},o=e=>{try{if(!e)return[];return a().filter(i).filter(r=>r.departureStation===e||r.arrivalStation===e||s(r.servedStations).some(r=>r.name===e))}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration des horaires:",e),[]}},d=function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departure",a=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(!e||!r)return null;try{if("departure"===t){if(e.departureStation===r)return e.isCancelled?e.departureTime:a&&e.delayMinutes?n(e.departureTime,e.delayMinutes):e.departureTime;let t=s(e.servedStations).find(e=>e.name===r);if(!t)return null;return a&&e.delayMinutes&&t.departureTime?n(t.departureTime,e.delayMinutes):t.departureTime||null}{if(e.arrivalStation===r)return e.isCancelled?e.arrivalTime:a&&e.delayMinutes?n(e.arrivalTime,e.delayMinutes):e.arrivalTime;let t=s(e.servedStations).find(e=>e.name===r);if(!t)return null;return a&&e.delayMinutes&&t.arrivalTime?n(t.arrivalTime,e.delayMinutes):t.arrivalTime||null}}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration de l'heure:",e),null}},c=function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departures";if(!e||!r)return[];try{return e.filter(e=>!!i(e)&&("departures"===t?e.departureStation===r||s(e.servedStations).some(e=>e.name===r&&e.departureTime):e.arrivalStation===r||s(e.servedStations).some(e=>e.name===r&&e.arrivalTime)))}catch(e){return console.error("Erreur lors du filtrage des horaires:",e),[]}},u=function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departures";if(!e||!r)return"";try{if("departures"===t){if(e.departureStation===r)return e.arrivalStation;let t=s(e.servedStations),a=t.findIndex(e=>e.name===r);if(-1!==a&&a<t.length-1)return t[a+1].name;return e.arrivalStation}{if(e.arrivalStation===r)return e.departureStation;let t=s(e.servedStations),a=t.findIndex(e=>e.name===r);if(a>0)return t[a-1].name;return e.departureStation}}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration de la destination/provenance:",e),""}},m=function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departures";if(!e||!r)return[];try{return[...e].sort((e,a)=>{let i=d(e,r,"departures"===t?"departure":"arrival")||"",s=d(a,r,"departures"===t?"departure":"arrival")||"";return i.localeCompare(s)})}catch(r){return console.error("Erreur lors du tri des horaires:",r),e}},p=e=>{let r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t=r.indexOf(e);return -1===t?null:r[(t+1)%r.length]},b=(e,r)=>e&&r?e.filter(e=>!e.joursCirculation||0===e.joursCirculation.length||e.joursCirculation.includes(r)):[]},5900:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/affichage-voyageurs",function(){return t(3377)}])}},e=>{var r=r=>e(e.s=r);e.O(0,[8585,8230,4587,1843,327,3779,636,6593,8792],()=>r(5900)),_N_E=e.O()}]);