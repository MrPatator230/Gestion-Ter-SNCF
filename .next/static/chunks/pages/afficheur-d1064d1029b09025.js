(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8085],{524:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var a=r(7876),s=r(4232);function l(e){if(!e)return null;let[t,r]=e.split(":").map(Number);return 60*t+r}function i(){return new Date().toISOString().split("T")[0]}function n(){let[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)(""),[d,c]=(0,s.useState)([]),[u,o]=(0,s.useState)({}),[m,h]=(0,s.useState)(i());(0,s.useEffect)(()=>{let e=localStorage.getItem("stations");e&&t(JSON.parse(e));let r=localStorage.getItem("schedules");r&&c(JSON.parse(r));let a=localStorage.getItem("trackAssignmentsBySchedule");a&&o(JSON.parse(a))},[]),(0,s.useEffect)(()=>{let e=setInterval(()=>{let e=i();e!==m&&h(e);let t=localStorage.getItem("schedules");t&&c(JSON.parse(t));let r=localStorage.getItem("trackAssignmentsBySchedule");r&&o(JSON.parse(r))},6e4);return()=>clearInterval(e)},[m]);let p=(e,t)=>{if(e.departureStation===t)return{arrivalTime:"",departureTime:e.departureTime};if(e.arrivalStation===t)return{arrivalTime:e.arrivalTime,departureTime:""};if(e.servedStations){let r=e.servedStations.find(e=>e.name===t);if(r)return{arrivalTime:r.arrivalTime||"",departureTime:r.departureTime||""}}return{arrivalTime:"",departureTime:""}},x=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date().getDay()],j=function(){let e=new Date;return 60*e.getHours()+e.getMinutes()}(),v=d.filter(e=>!!e.joursCirculation&&!!e.joursCirculation.includes(x)&&!!(e.departureStation===r||e.arrivalStation===r||e.servedStations&&e.servedStations.some(e=>e.name===r))),S=[],f=[];v.forEach(e=>{let t=p(e,r);if(t.arrivalTime){let r=l(t.arrivalTime);null!==r&&r>=j&&S.push({schedule:e,time:t.arrivalTime})}if(t.departureTime){let r=l(t.departureTime);null!==r&&r>=j&&f.push({schedule:e,time:t.departureTime})}}),S.sort((e,t)=>e.time.localeCompare(t.time)),f.sort((e,t)=>e.time.localeCompare(t.time));let g=e=>{let t=l(e);return null!==t&&j>=t-30},b=(e,t)=>e.stopStatus&&e.stopStatus[t]?e.stopStatus[t]:{status:e.status||"on_time",delayMinutes:e.delayMinutes||0};return(0,a.jsxs)("div",{style:{backgroundColor:"#cce7ff",minHeight:"100vh",padding:"1rem"},children:[(0,a.jsx)("h1",{className:"text-center mb-4",children:"Afficheur SNCF - Arriv\xe9es et D\xe9parts"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"stationSelect",className:"form-label fw-semibold",children:"S\xe9lectionnez une gare"}),(0,a.jsxs)("select",{id:"stationSelect",className:"form-select form-select-lg",value:r,onChange:e=>n(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"-- Choisir une gare --"}),e.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.name))]})]}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("div",{className:"col-md-6",style:{borderRight:"2px solid #007bff",paddingRight:"1rem"},children:[(0,a.jsxs)("h2",{className:"text-center mb-3",style:{color:"green"},children:["Arriv\xe9es ",(0,a.jsx)("span",{style:{fontSize:"1.5rem"},children:"\uD83E\uDC46"})]}),0===S.length?(0,a.jsx)("p",{className:"text-center text-muted",children:"Aucune arriv\xe9e trouv\xe9e pour cette gare."}):(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)("table",{className:"table table-striped table-bordered text-center align-middle",children:[(0,a.jsx)("thead",{className:"table-dark",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Train"}),(0,a.jsx)("th",{children:"Provenance"}),(0,a.jsx)("th",{children:"Heure d'arriv\xe9e"}),(0,a.jsx)("th",{children:"Voie"}),(0,a.jsx)("th",{children:"Statut"})]})}),(0,a.jsx)("tbody",{children:S.map(e=>{var t;let{schedule:s,time:l}=e,i=g(l)&&(null==(t=u[s.id])?void 0:t[r])?u[s.id][r]:"-",n=b(s,r),d="on_time"===n.status?"\xc0 l'heure":"delayed"===n.status?"En retard (".concat(n.delayMinutes," min)"):"Supprim\xe9";return(0,a.jsxs)("tr",{className:"fs-5 fw-bold",children:[(0,a.jsx)("td",{children:s.trainNumber}),(0,a.jsx)("td",{children:s.departureStation}),(0,a.jsx)("td",{children:l}),(0,a.jsx)("td",{children:i}),(0,a.jsx)("td",{children:d})]},s.id)})})]})})]}),(0,a.jsxs)("div",{className:"col-md-6",style:{paddingLeft:"1rem"},children:[(0,a.jsxs)("h2",{className:"text-center mb-3",style:{color:"blue"},children:["D\xe9parts ",(0,a.jsx)("span",{style:{fontSize:"1.5rem"},children:"\uD83E\uDC46"})]}),0===f.length?(0,a.jsx)("p",{className:"text-center text-muted",children:"Aucun d\xe9part trouv\xe9 pour cette gare."}):(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)("table",{className:"table table-striped table-bordered text-center align-middle",children:[(0,a.jsx)("thead",{className:"table-dark",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Train"}),(0,a.jsx)("th",{children:"Destination"}),(0,a.jsx)("th",{children:"Heure de d\xe9part"}),(0,a.jsx)("th",{children:"Voie"}),(0,a.jsx)("th",{children:"Statut"})]})}),(0,a.jsx)("tbody",{children:f.map(e=>{var t;let{schedule:s,time:l}=e,i=g(l)&&(null==(t=u[s.id])?void 0:t[r])?u[s.id][r]:"-",n=b(s,r),d="on_time"===n.status?"\xc0 l'heure":"delayed"===n.status?"En retard (".concat(n.delayMinutes," min)"):"Supprim\xe9";return(0,a.jsxs)("tr",{className:"fs-5 fw-bold",children:[(0,a.jsx)("td",{children:s.trainNumber}),(0,a.jsx)("td",{children:s.arrivalStation}),(0,a.jsx)("td",{children:l}),(0,a.jsx)("td",{children:i}),(0,a.jsx)("td",{children:d})]},s.id)})})]})})]})]}),0===S.length&&0===f.length&&(0,a.jsx)("p",{className:"text-center mt-4 fst-italic",children:"Les prochains d\xe9parts auront lieu demain"})]})]})}},5406:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/afficheur",function(){return r(524)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(5406)),_N_E=e.O()}]);